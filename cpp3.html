<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillSphere</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="w-full min-h-screen bg-gray-100 p-4">
        <header>
            <div style="display: flex; align-items: center; width: 100%;">
                <div class="logo">
                    <img src="final_logo.png" alt="SkillSphere Logo" class="logo-img" style="margin-right: 5px;">
                    <span style="margin-left: 0; font-weight: bold; font-size: 1.5em;">SkillSphere</span>
                </div>
                <input type="text" placeholder="What skills you want to learn?" class="search-bar" onclick="window.location.href='serch.html'" style="margin-left: 40px;">
                <div class="profile" style="display: flex; align-items: center; gap: 30px; margin-left: 50px;">
                    <span class="user-icon" onclick="window.location.href='notification.html'">üîî</span>
                    <span class="user-icon" onclick="window.location.href='mail.html'">üìß</span>
                    <span class="user-icon" onclick="window.location.href='fav.html'">‚ù§Ô∏è</span>
                    <span class="user-icon" onclick="window.location.href='main.html'">üè†</span>
                    <span class="user-icon" onclick="window.location.href='profile.html'">üë§</span>
                </div>
            </div>
        </header>
        <hr style="margin: 20px 0; border: 1px solid #ccc;">
    </div>

    <h2>C++ - Level 3</h2>
    <div id="quizContainer">
        <form id="quizForm">
            <div id="questionContainer"></div>
            <button type="button" id="backButton" onclick="previousQuestion()" class="hidden">Back</button>
            <button type="button" id="nextButton" onclick="nextQuestion()">Next</button>
        </form>
        <p id="result" class="hidden"></p>
        <button id="retakeButton" class="hidden" onclick="resetQuiz()">Retry</button>
        <button id="backToTestPageButton" class="hidden" onclick="window.location.href='test.html'">Back to Test Page</button>
    </div>

    <script>
        const questions = [
            {
            {
                "type": "code",
                "question": "Write a C++ program that takes an integer as input and prints the square of that number.",
                "image": "cppq31.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program that reads three numbers and prints their sum.",
                "image": "cppq32.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program that checks if a number is prime or not.",
                "image": "cppq33.1.png,cppq33.2.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program that reverses a given string.",
                "image": "cppq34.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program to implement a class Matrix that can perform matrix addition, subtraction, and multiplication. The class should have the following methods:\n\n1. Constructor to initialize a matrix with given rows and columns.\n2. Method for matrix addition.\n3. Method for matrix subtraction.\n4. Method for matrix multiplication.\n5. Method to display the matrix.",
                "image": "cppq35.1.png,cppq35.2.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program to implement a Dynamic Array class that supports the following operations:\n\n1. Adding an element to the array.\n2. Removing an element from the array.\n3. Displaying the elements of the array.\n4. Sorting the array in ascending order (implement a sorting algorithm such as Bubble Sort).\n5. Searching an element in the array (implement a search algorithm like Binary Search).\n6. Resizing the array when it is full.\n7. Implement deep copy constructor and assignment operator for safe memory handling.",
                "image": "cppq36.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program that implements a Student Management System. The system should manage a list of students, where each student has:\n\n1. A name.\n2. An ID.\n3. A list of courses the student is enrolled in.\n4. A grade for each course.\n\nThe program should support the following operations:\n\n1. Adding a student.\n2. Removing a student by ID.\n3. Displaying the details of all students.\n4. Displaying the details of a student by ID.\n5. Updating the grade of a student for a particular course.\n6. Searching for a student by name or ID.\n7. Listing all students enrolled in a specific course.",
                "image": "cppq37.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            },
            {
                "type": "code",
                "question": "Write a C++ program that implements a Simple Bank System. The system should support the following operations:\n\n1. Creating an account with a unique account number, name, and initial balance.\n2. Depositing money into an account.\n3. Withdrawing money from an account (check if sufficient balance exists).\n4. Displaying the account details (account number, name, and balance).\n5. Transferring money between two accounts.\n6. Listing all accounts with their balances.\n\nImplement error handling for invalid transactions (e.g., insufficient balance for withdrawal).",
                "image": "cppq38.png",
                "options": [],
                "answer": "",
                "inputAnswer": true
            }
        let currentQuestionIndex = 0;
        let score = 0;

        // Shuffle the questions array
        function shuffleQuestions() {
            for (let i = questions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [questions[i], questions[j]] = [questions[j], questions[i]];
            }
        }
        
        // Shuffle questions before starting the quiz
        shuffleQuestions();

        // Clear progress immediately when the page is loaded
        window.addEventListener('load', () => {
            resetQuiz(); // Clear the quiz progress on page load
        });

        // Add a reminder for the user if they leave the page
        window.addEventListener('beforeunload', (event) => {
            event.preventDefault();
            event.returnValue = 'Are you sure you want to leave? Your progress will not be saved.';
        });

        function loadQuestion() {
        const questionData = questions[currentQuestionIndex];
        const questionContainer = document.getElementById('questionContainer');
        questionContainer.innerHTML = '';
        const questionElement = document.createElement('p');
        questionElement.innerHTML = `${questionData.question}`;
        questionContainer.appendChild(questionElement);

        if (questionData.inputAnswer) {
            const inputBox = document.createElement('div');
            inputBox.innerHTML = questionData.renderInputBox();
            questionContainer.appendChild(inputBox);
        } else if (questionData.options) {
            questionData.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option-container');
                optionElement.innerHTML = `
                <input type="radio" name="q${currentQuestionIndex}" value="${String.fromCharCode(97 + index)}" id="q${currentQuestionIndex}_${index}">
                <label for="q${currentQuestionIndex}_${index}">${option}</label>
                `;
                questionContainer.appendChild(optionElement);
            });
        }

        document.getElementById('backButton').classList.toggle('hidden', currentQuestionIndex === 0);
        }

        // Limit the quiz to display only the first 10 questions
        const maxQuestions = 10;
        if (questions.length > maxQuestions) {
            questions.splice(maxQuestions);
        }

        let isQuizStarted = false;

         // Add event listener to warn the user before leaving the page
        window.addEventListener('beforeunload', (event) => {
            if (isQuizStarted) {
                event.preventDefault();
                event.returnValue = 'Are you sure you want to leave? Your progress will be lost.';
            }
        });

        // Clear progress if the user confirms leaving
        window.addEventListener('unload', () => {
            if (isQuizStarted) {
                resetQuiz(); // Clear the quiz progress
            }
        });

        function nextQuestion() {
            const userInput = document.querySelector('textarea[name="userAnswer"]');
            if (!userInput || userInput.value.trim() === '') {
            alert('Please input your answer before proceeding.');
            return;
            }

            // Save the user's input answer for the current question
            questions[currentQuestionIndex].saveAnswer(userInput.value.trim());

            currentQuestionIndex++;

            if (currentQuestionIndex < questions.length) {
            loadQuestion();
            } else {
            showResult();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
            }
        }

        function showResult() {
            document.getElementById('quizForm').classList.add('hidden');
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = `Thank you for completing the quiz. Your answers have been submitted successfully. <div><br>You will receive a notification about your score within 7 working days. Please check your mailbox for updates.</div>`;
            document.getElementById('result').classList.remove('hidden');
            document.getElementById('backToTestPageButton').classList.remove('hidden'); // Show the back to test page button
        }

        // Modify resetQuiz to reshuffle questions on retry
        function resetQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            isQuizStarted = false; // Reset quiz state
            shuffleQuestions(); // Reshuffle questions for a new random order
            document.getElementById('quizForm').classList.remove('hidden');
            document.getElementById('result').classList.add('hidden');
            document.getElementById('retakeButton').classList.add('hidden');
            document.getElementById('backToTestPageButton').classList.add('hidden');
            loadQuestion();
        }

        // Initialize the first question
        loadQuestion();
    </script>
</body>
</html>